{
  "_args": [
    [
      {
        "raw": "node-redis-warlock@~0.2.0",
        "scope": null,
        "escapedName": "node-redis-warlock",
        "name": "node-redis-warlock",
        "rawSpec": "~0.2.0",
        "spec": ">=0.2.0 <0.3.0",
        "type": "range"
      },
      "/var/stf/node_modules/kue"
    ]
  ],
  "_from": "node-redis-warlock@>=0.2.0 <0.3.0",
  "_id": "node-redis-warlock@0.2.0",
  "_inCache": true,
  "_location": "/node-redis-warlock",
  "_nodeVersion": "4.2.4",
  "_npmUser": {
    "name": "thedeveloper",
    "email": "geoff@gosquared.com"
  },
  "_npmVersion": "2.14.12",
  "_phantomChildren": {},
  "_requested": {
    "raw": "node-redis-warlock@~0.2.0",
    "scope": null,
    "escapedName": "node-redis-warlock",
    "name": "node-redis-warlock",
    "rawSpec": "~0.2.0",
    "spec": ">=0.2.0 <0.3.0",
    "type": "range"
  },
  "_requiredBy": [
    "/kue"
  ],
  "_resolved": "https://registry.npmjs.org/node-redis-warlock/-/node-redis-warlock-0.2.0.tgz",
  "_shasum": "56395b994c828e8e32f6aae53b93b6edfcd97990",
  "_shrinkwrap": null,
  "_spec": "node-redis-warlock@~0.2.0",
  "_where": "/var/stf/node_modules/kue",
  "author": {
    "name": "Geoff Wagstaff"
  },
  "bugs": {
    "url": "https://github.com/thedeveloper/warlock/issues"
  },
  "dependencies": {
    "node-redis-scripty": "0.0.5",
    "uuid": "^2.0.1"
  },
  "description": "Battle-hardened distributed locking using redis",
  "devDependencies": {
    "async": "^1.5.1",
    "mocha": "^2.3.4",
    "redis": "^2.4.2",
    "should": "^8.0.2"
  },
  "directories": {},
  "dist": {
    "shasum": "56395b994c828e8e32f6aae53b93b6edfcd97990",
    "tarball": "https://registry.npmjs.org/node-redis-warlock/-/node-redis-warlock-0.2.0.tgz"
  },
  "gitHead": "13765ee86abe008aed492fc0015a8b87f77af2b7",
  "homepage": "https://github.com/thedeveloper/warlock",
  "keywords": [
    "node.js",
    "redis",
    "lock"
  ],
  "license": "MIT",
  "main": "lib/warlock.js",
  "maintainers": [
    {
      "name": "thedeveloper",
      "email": "geoff@gosquared.com"
    }
  ],
  "name": "node-redis-warlock",
  "optionalDependencies": {},
  "readme": "warlock\n=======\n\n[![Travis](https://travis-ci.org/TheDeveloper/warlock.svg?branch=master)](https://travis-ci.org/TheDeveloper/warlock)\n[![Dependency Status](https://david-dm.org/thedeveloper/warlock.svg)](https://david-dm.org/thedeveloper/warlock)\n[![Join the chat at https://gitter.im/TheDeveloper/warlock](https://badges.gitter.im/Join%20Chat.svg)](https://gitter.im/TheDeveloper/warlock?utm_source=badge&utm_medium=badge&utm_campaign=pr-badge&utm_content=badge)\n\nBattle-hardened distributed locking using redis.\n\n## Requirements\n\n* [node-redis](https://github.com/mranney/node_redis) compatible with `v0.10`\n* Redis `v2.6.12` or above. If you're running a Redis version from `v2.6.0` to `v2.6.11` inclusive use `v0.0.7` of this module.\n\n## Install\n\n    npm install node-redis-warlock\n\n## Usage\n\n```javascript\n\nvar Warlock = require('node-redis-warlock');\nvar redis = require('redis');\n\n// Establish a redis client and pass it to warlock\nvar redis = redis.createClient();\nvar warlock = Warlock(redis);\n\n// Set a lock\nvar key = 'test-lock';\nvar ttl = 10000; // Lifetime of the lock\n\nwarlock.lock(key, ttl, function(err, unlock){\n  if (err) {\n    // Something went wrong and we weren't able to set a lock\n    return;\n  }\n\n  if (typeof unlock === 'function') {\n    // If the lock is set successfully by this process, an unlock function is passed to our callback.\n    // Do the work that required lock protection, and then unlock() when finished...\n    //\n    // do stuff...\n    //\n    unlock();\n  } else {\n    // Otherwise, the lock was not established by us so we must decide what to do\n    // Perhaps wait a bit & retry...\n  }\n});\n\n// set a lock optimistically\nvar key = 'opt-lock';\nvar ttl = 10000;\nvar maxAttempts = 4; // Max number of times to try setting the lock before erroring\nvar wait = 1000; // Time to wait before another attempt if lock already in place\nwarlock.optimistic(key, ttl, maxAttempts, wait, function(err, unlock) {});\n\n// unlock using the lock id\nvar key = 'test-lock-2';\nvar ttl = 10000;\nvar lockId;\n\nwarlock.lock(key, ttl, function(err, _, id) {\n  lockId = id;\n});\n\n// each client who knows the lockId can release the lock\nwarlock.unlock(key, lockId, function(err, result) {\n  if(result == 1) {\n    // unlocked successfully\n  }\n});\n\n```\n\n## ProTips\n\n* Read my [Distributed locks using Redis](https://engineering.gosquared.com/distributed-locks-using-redis) article and Redis' author's [A proposal for more reliable locks using Redis](http://antirez.com/news/77) to learn more about the theory of distributed locks using Redis.\n",
  "readmeFilename": "README.md",
  "repository": {
    "type": "git",
    "url": "git+https://github.com/thedeveloper/warlock.git"
  },
  "scripts": {
    "bench": "mocha -R list ./test/bench",
    "test": "mocha -R list ./test/warlock"
  },
  "version": "0.2.0"
}
